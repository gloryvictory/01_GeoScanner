# 01_GeoScanner
`01_GeoScanner` is a recursive file lister (SHP Files, MIF/MID, GDB, etc...).

# Why
There are not any tools for this task.

# License - MIT

Версия документа: 1.0

Год: 2019

Имя проекта – **MyGeo** (**01_GeoScanner** - индексатор)

Авторы: **Замараев Вячеслав (постановка задачи)**

Разработчики: **Замараев Вячеслав (PYTHON)**, **Громов Игорь (PowerShell)** 


# Цель проекта
Получить точную и исчерпывающую информацию о существовании и использовании пространственных данных внутри компании. 

# Основная идея
Просканировать всю файловую систему (на Windows машинах - все диски) и создать файл с с набором критериев, затем этот файл анализировать и встраивать функции работы с пространственными данными (загрузка в центральное хранилище или в PostgreSQL+PostGIS)
На этапе анализа будут участвовать слудующие типы данных: 
Пространственные данные (по расширениям):

Вектор: shp, shx, dbf, prj, cbn, xml, MIF, MID, tab, kml, kmz, gps, map

Растр: tif, tiff, jpg, jpeg, geotiff

# Модуль индексатора "01_GeoScanner"
Может быть написан на любом языке программирования: PowerShell, Go, Python, C#
Алгоритм:
1) Получает имя машины (компьютера) 
2) Пробегает по каждому диску в операционной системе и формирует список файлов и его атрибутов (полный путь, размер, дата создания)
3) Формирует CSV файл, имя которого состоит из: ИмяМашины_Диск.csv (например CompZamaraev_c.csv)
4) Все значения могут (но не обязательно) обрамляться в кавычки «”» 

Пример: DESKTOP-NBV0BJF_C.csv, где DESKTOP-NBV0BJF – имя машины, а С – имя диска 
На выходе:   ИмяМашины_Диск.csv

Имена полей: **"$compname";"FullName";"Length";"CreationTime";"ModifiedTime";"AccessTime"**

Пример файла **DESKTOP-NBV0BJF-C.csv**: 

"$compname";"FullName";"Length";"CreationTime";"ModifiedTime";"AccessTime"

"DESKTOP-NBV0BJF";"C:\$compname.csv";"916144";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01"

"DESKTOP-NBV0BJF";"C:\01_GeoScanner\01_GeoScanner.log";"5361";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01"

"DESKTOP-NBV0BJF";"C:\01_GeoScanner\exclusions.txt";"50";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01";"916144";"05.03.2019 19:47:01"

Получается таблица:

|$compname|FullName|Length|CreationTime|ModifiedTime|AccessTime
|---------|--------|------|------------|------------|------------|
|---------|--------|------|------------|------------|------------|

# Модуль анализа данных

Цель: Проанализировать получившуюя таблицу и собрать статистическую информацию.

##Вид 1: Статистика по типам файлов 

|имя машины|диск|тип|размер|
|----------|:----:|:---:|------:|
|zamaraev  |C   |SHP|20 Gb |
|zamaraev  |C   |MIF|10 Gb |
|zamaraev  |C   |TAB|10 Mb |
|zamaraev  |C   |...|.. Gb |


При анализе неообходимо учитывать, что SHP файл это набор из нескольких файлов (SHP+SHX+DBF+PRJ+SBN+SBX+...) и выводить надо размер суммарно для всех файлов.
Алгоритм: 

1. ищем файл *.shp (например нашли river.shp)
2. в этой же папке ищем файлы с таким же именем, но другими расширениями, например

|имя файла |тип |размер|
|----------|:---:|-----:|
|river.shp |SHP |20 b |
|river.shx |SHX |10 b |
|river.dbf |DBF |220 b |
|river.prj |PRJ |10 b |

Итого для шейп файла river.shp итоговый размер в таблице будет (20_10+220+10) = 260 байт. 
И так далее по всем файлам...

Также для пары MIF и MID размер считается общий (rivers.mif + rivers.mid)

В конце каждой таблицы подводится итог по всем типам пространственных данных на диске.

**ИТОГО** = **200 Gb** (21474836480 в байтах) 


##Вид 2: Статистика по SHP файлам (по размерам)

Таблица имеет следующий вид: 

|имя shp|SHP|SHX|DBF|PRJ|SBN|SBX|...|размер|
|----------|:----:|:---:|:---:|:----:|:---:|:---:|:----:|---:|
|river  |20   |10|220 |20   |0|0 |0   |260|
|admin  |20   |10|220 |20   |10|10 |0   |280|
|**Итого**  |**40**   |**20**|**440** |**40**   |**10**|**10** |**0**   |**540**|


Т.е. столбцы - это расширения файлов, а последний это сумма каждой ячейки (с цифрой)     
и в конце таблицы выводится информация суммарно по каждому столбцу

##Вид 3: Статистика по SHP файлам (по наличию) 

Таблица имеет следующий вид: 

|имя shp|SHP|SHX|DBF|PRJ|SBN|SBX|...|размер|
|----------|:----:|:---:|:---:|:----:|:---:|:---:|:----:|---:|
|river  |1   |1|1 |1   |0|0 |0   |4|
|admin  |1   |1|1 |1   |1|1 |0   |6|
|**Итого**  |**2**   |**2**|**2** |**2**   |**1**|**1** |**0**   |**10**|

Т.е. столбцы - это расширения файлов, а последний это сумма каждой ячейки (с цифрой)

* **1** - если файл с таким расширением **ЕСТЬ** 

* **0** - если файла с таким расширением **НЕТ**     

и в конце таблицы выводится информация суммарно по каждому столбцу







